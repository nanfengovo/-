function e() {
  return e = Object.assign ? Object.assign.bind() : function(e2) {
    for (var r2 = 1; r2 < arguments.length; r2++) {
      var t2 = arguments[r2];
      for (var n2 in t2)
        Object.prototype.hasOwnProperty.call(t2, n2) && (e2[n2] = t2[n2]);
    }
    return e2;
  }, e.apply(this, arguments);
}
function r(e2) {
  return r = Object.setPrototypeOf ? Object.getPrototypeOf.bind() : function(e3) {
    return e3.__proto__ || Object.getPrototypeOf(e3);
  }, r(e2);
}
function t(e2, r2) {
  return t = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function(e3, r3) {
    return e3.__proto__ = r3, e3;
  }, t(e2, r2);
}
function n(e2, r2, i2) {
  return n = function() {
    if ("undefined" == typeof Reflect || !Reflect.construct)
      return false;
    if (Reflect.construct.sham)
      return false;
    if ("function" == typeof Proxy)
      return true;
    try {
      return Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function() {
      })), true;
    } catch (e3) {
      return false;
    }
  }() ? Reflect.construct.bind() : function(e3, r3, n2) {
    var i3 = [null];
    i3.push.apply(i3, r3);
    var a2 = new (Function.bind.apply(e3, i3))();
    return n2 && t(a2, n2.prototype), a2;
  }, n.apply(null, arguments);
}
function i(e2) {
  var a2 = "function" == typeof Map ? /* @__PURE__ */ new Map() : void 0;
  return i = function(e3) {
    if (null === e3 || (i2 = e3, -1 === Function.toString.call(i2).indexOf("[native code]")))
      return e3;
    var i2;
    if ("function" != typeof e3)
      throw new TypeError("Super expression must either be null or a function");
    if (void 0 !== a2) {
      if (a2.has(e3))
        return a2.get(e3);
      a2.set(e3, u2);
    }
    function u2() {
      return n(e3, arguments, r(this).constructor);
    }
    return u2.prototype = Object.create(e3.prototype, { constructor: { value: u2, enumerable: false, writable: true, configurable: true } }), t(u2, e3);
  }, i(e2);
}
var a = /%[sdj%]/g, u = function() {
};
function s(e2) {
  if (!e2 || !e2.length)
    return null;
  var r2 = {};
  return e2.forEach(function(e3) {
    var t2 = e3.field;
    r2[t2] = r2[t2] || [], r2[t2].push(e3);
  }), r2;
}
function o(e2) {
  for (var r2 = arguments.length, t2 = new Array(r2 > 1 ? r2 - 1 : 0), n2 = 1; n2 < r2; n2++)
    t2[n2 - 1] = arguments[n2];
  var i2 = 0, u2 = t2.length;
  return "function" == typeof e2 ? e2.apply(null, t2) : "string" == typeof e2 ? e2.replace(a, function(e3) {
    if ("%%" === e3)
      return "%";
    if (i2 >= u2)
      return e3;
    switch (e3) {
      case "%s":
        return String(t2[i2++]);
      case "%d":
        return Number(t2[i2++]);
      case "%j":
        try {
          return JSON.stringify(t2[i2++]);
        } catch (e4) {
          return "[Circular]";
        }
        break;
      default:
        return e3;
    }
  }) : e2;
}
function f(e2, r2) {
  return null == e2 || (!("array" !== r2 || !Array.isArray(e2) || e2.length) || !(!function(e3) {
    return "string" === e3 || "url" === e3 || "hex" === e3 || "email" === e3 || "date" === e3 || "pattern" === e3;
  }(r2) || "string" != typeof e2 || e2));
}
function l(e2, r2, t2) {
  var n2 = 0, i2 = e2.length;
  !function a2(u2) {
    if (u2 && u2.length)
      t2(u2);
    else {
      var s2 = n2;
      n2 += 1, s2 < i2 ? r2(e2[s2], a2) : t2([]);
    }
  }([]);
}
"undefined" != typeof process && process.env;
var c = function(e2) {
  var r2, n2;
  function i2(r3, t2) {
    var n3;
    return (n3 = e2.call(this, "Async Validation Error") || this).errors = r3, n3.fields = t2, n3;
  }
  return n2 = e2, (r2 = i2).prototype = Object.create(n2.prototype), r2.prototype.constructor = r2, t(r2, n2), i2;
}(i(Error));
function d(e2, r2, t2, n2, i2) {
  if (r2.first) {
    var a2 = new Promise(function(r3, a3) {
      var u3 = function(e3) {
        var r4 = [];
        return Object.keys(e3).forEach(function(t3) {
          r4.push.apply(r4, e3[t3] || []);
        }), r4;
      }(e2);
      l(u3, t2, function(e3) {
        return n2(e3), e3.length ? a3(new c(e3, s(e3))) : r3(i2);
      });
    });
    return a2.catch(function(e3) {
      return e3;
    }), a2;
  }
  var u2 = true === r2.firstFields ? Object.keys(e2) : r2.firstFields || [], o2 = Object.keys(e2), f2 = o2.length, d2 = 0, p2 = [], y2 = new Promise(function(r3, a3) {
    var y3 = function(e3) {
      if (p2.push.apply(p2, e3), ++d2 === f2)
        return n2(p2), p2.length ? a3(new c(p2, s(p2))) : r3(i2);
    };
    o2.length || (n2(p2), r3(i2)), o2.forEach(function(r4) {
      var n3 = e2[r4];
      -1 !== u2.indexOf(r4) ? l(n3, t2, y3) : function(e3, r5, t3) {
        var n4 = [], i3 = 0, a4 = e3.length;
        function u3(e4) {
          n4.push.apply(n4, e4 || []), ++i3 === a4 && t3(n4);
        }
        e3.forEach(function(e4) {
          r5(e4, u3);
        });
      }(n3, t2, y3);
    });
  });
  return y2.catch(function(e3) {
    return e3;
  }), y2;
}
function p(e2, r2) {
  return function(t2) {
    var n2, i2;
    return n2 = e2.fullFields ? function(e3, r3) {
      for (var t3 = e3, n3 = 0; n3 < r3.length; n3++) {
        if (null == t3)
          return t3;
        t3 = t3[r3[n3]];
      }
      return t3;
    }(r2, e2.fullFields) : r2[t2.field || e2.fullField], (i2 = t2) && void 0 !== i2.message ? (t2.field = t2.field || e2.fullField, t2.fieldValue = n2, t2) : { message: "function" == typeof t2 ? t2() : t2, fieldValue: n2, field: t2.field || e2.fullField };
  };
}
function y(r2, t2) {
  if (t2) {
    for (var n2 in t2)
      if (t2.hasOwnProperty(n2)) {
        var i2 = t2[n2];
        "object" == typeof i2 && "object" == typeof r2[n2] ? r2[n2] = e({}, r2[n2], i2) : r2[n2] = i2;
      }
  }
  return r2;
}
var g, h = function(e2, r2, t2, n2, i2, a2) {
  !e2.required || t2.hasOwnProperty(e2.field) && !f(r2, a2 || e2.type) || n2.push(o(i2.messages.required, e2.fullField));
}, v = /^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+\.)+[a-zA-Z\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]{2,}))$/, m = /^#?([a-f0-9]{6}|[a-f0-9]{3})$/i, b = { integer: function(e2) {
  return b.number(e2) && parseInt(e2, 10) === e2;
}, float: function(e2) {
  return b.number(e2) && !b.integer(e2);
}, array: function(e2) {
  return Array.isArray(e2);
}, regexp: function(e2) {
  if (e2 instanceof RegExp)
    return true;
  try {
    return !!new RegExp(e2);
  } catch (e3) {
    return false;
  }
}, date: function(e2) {
  return "function" == typeof e2.getTime && "function" == typeof e2.getMonth && "function" == typeof e2.getYear && !isNaN(e2.getTime());
}, number: function(e2) {
  return !isNaN(e2) && "number" == typeof e2;
}, object: function(e2) {
  return "object" == typeof e2 && !b.array(e2);
}, method: function(e2) {
  return "function" == typeof e2;
}, email: function(e2) {
  return "string" == typeof e2 && e2.length <= 320 && !!e2.match(v);
}, url: function(e2) {
  return "string" == typeof e2 && e2.length <= 2048 && !!e2.match(function() {
    if (g)
      return g;
    var e3 = "[a-fA-F\\d:]", r2 = function(r3) {
      return r3 && r3.includeBoundaries ? "(?:(?<=\\s|^)(?=" + e3 + ")|(?<=" + e3 + ")(?=\\s|$))" : "";
    }, t2 = "(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)(?:\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)){3}", n2 = "[a-fA-F\\d]{1,4}", i2 = ("\n(?:\n(?:" + n2 + ":){7}(?:" + n2 + "|:)|                                    // 1:2:3:4:5:6:7::  1:2:3:4:5:6:7:8\n(?:" + n2 + ":){6}(?:" + t2 + "|:" + n2 + "|:)|                             // 1:2:3:4:5:6::    1:2:3:4:5:6::8   1:2:3:4:5:6::8  1:2:3:4:5:6::1.2.3.4\n(?:" + n2 + ":){5}(?::" + t2 + "|(?::" + n2 + "){1,2}|:)|                   // 1:2:3:4:5::      1:2:3:4:5::7:8   1:2:3:4:5::8    1:2:3:4:5::7:1.2.3.4\n(?:" + n2 + ":){4}(?:(?::" + n2 + "){0,1}:" + t2 + "|(?::" + n2 + "){1,3}|:)| // 1:2:3:4::        1:2:3:4::6:7:8   1:2:3:4::8      1:2:3:4::6:7:1.2.3.4\n(?:" + n2 + ":){3}(?:(?::" + n2 + "){0,2}:" + t2 + "|(?::" + n2 + "){1,4}|:)| // 1:2:3::          1:2:3::5:6:7:8   1:2:3::8        1:2:3::5:6:7:1.2.3.4\n(?:" + n2 + ":){2}(?:(?::" + n2 + "){0,3}:" + t2 + "|(?::" + n2 + "){1,5}|:)| // 1:2::            1:2::4:5:6:7:8   1:2::8          1:2::4:5:6:7:1.2.3.4\n(?:" + n2 + ":){1}(?:(?::" + n2 + "){0,4}:" + t2 + "|(?::" + n2 + "){1,6}|:)| // 1::              1::3:4:5:6:7:8   1::8            1::3:4:5:6:7:1.2.3.4\n(?::(?:(?::" + n2 + "){0,5}:" + t2 + "|(?::" + n2 + "){1,7}|:))             // ::2:3:4:5:6:7:8  ::2:3:4:5:6:7:8  ::8             ::1.2.3.4\n)(?:%[0-9a-zA-Z]{1,})?                                             // %eth0            %1\n").replace(/\s*\/\/.*$/gm, "").replace(/\n/g, "").trim(), a2 = new RegExp("(?:^" + t2 + "$)|(?:^" + i2 + "$)"), u2 = new RegExp("^" + t2 + "$"), s2 = new RegExp("^" + i2 + "$"), o2 = function(e4) {
      return e4 && e4.exact ? a2 : new RegExp("(?:" + r2(e4) + t2 + r2(e4) + ")|(?:" + r2(e4) + i2 + r2(e4) + ")", "g");
    };
    o2.v4 = function(e4) {
      return e4 && e4.exact ? u2 : new RegExp("" + r2(e4) + t2 + r2(e4), "g");
    }, o2.v6 = function(e4) {
      return e4 && e4.exact ? s2 : new RegExp("" + r2(e4) + i2 + r2(e4), "g");
    };
    var f2 = o2.v4().source, l2 = o2.v6().source;
    return g = new RegExp("(?:^(?:(?:(?:[a-z]+:)?//)|www\\.)(?:\\S+(?::\\S*)?@)?(?:localhost|" + f2 + "|" + l2 + '|(?:(?:[a-z\\u00a1-\\uffff0-9][-_]*)*[a-z\\u00a1-\\uffff0-9]+)(?:\\.(?:[a-z\\u00a1-\\uffff0-9]-*)*[a-z\\u00a1-\\uffff0-9]+)*(?:\\.(?:[a-z\\u00a1-\\uffff]{2,})))(?::\\d{2,5})?(?:[/?#][^\\s"]*)?$)', "i");
  }());
}, hex: function(e2) {
  return "string" == typeof e2 && !!e2.match(m);
} }, q = "enum", w = { required: h, whitespace: function(e2, r2, t2, n2, i2) {
  (/^\s+$/.test(r2) || "" === r2) && n2.push(o(i2.messages.whitespace, e2.fullField));
}, type: function(e2, r2, t2, n2, i2) {
  if (e2.required && void 0 === r2)
    h(e2, r2, t2, n2, i2);
  else {
    var a2 = e2.type;
    ["integer", "float", "array", "regexp", "object", "method", "email", "number", "date", "url", "hex"].indexOf(a2) > -1 ? b[a2](r2) || n2.push(o(i2.messages.types[a2], e2.fullField, e2.type)) : a2 && typeof r2 !== e2.type && n2.push(o(i2.messages.types[a2], e2.fullField, e2.type));
  }
}, range: function(e2, r2, t2, n2, i2) {
  var a2 = "number" == typeof e2.len, u2 = "number" == typeof e2.min, s2 = "number" == typeof e2.max, f2 = r2, l2 = null, c2 = "number" == typeof r2, d2 = "string" == typeof r2, p2 = Array.isArray(r2);
  if (c2 ? l2 = "number" : d2 ? l2 = "string" : p2 && (l2 = "array"), !l2)
    return false;
  p2 && (f2 = r2.length), d2 && (f2 = r2.replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g, "_").length), a2 ? f2 !== e2.len && n2.push(o(i2.messages[l2].len, e2.fullField, e2.len)) : u2 && !s2 && f2 < e2.min ? n2.push(o(i2.messages[l2].min, e2.fullField, e2.min)) : s2 && !u2 && f2 > e2.max ? n2.push(o(i2.messages[l2].max, e2.fullField, e2.max)) : u2 && s2 && (f2 < e2.min || f2 > e2.max) && n2.push(o(i2.messages[l2].range, e2.fullField, e2.min, e2.max));
}, enum: function(e2, r2, t2, n2, i2) {
  e2[q] = Array.isArray(e2[q]) ? e2[q] : [], -1 === e2[q].indexOf(r2) && n2.push(o(i2.messages[q], e2.fullField, e2[q].join(", ")));
}, pattern: function(e2, r2, t2, n2, i2) {
  if (e2.pattern) {
    if (e2.pattern instanceof RegExp)
      e2.pattern.lastIndex = 0, e2.pattern.test(r2) || n2.push(o(i2.messages.pattern.mismatch, e2.fullField, r2, e2.pattern));
    else if ("string" == typeof e2.pattern) {
      new RegExp(e2.pattern).test(r2) || n2.push(o(i2.messages.pattern.mismatch, e2.fullField, r2, e2.pattern));
    }
  }
} }, F = function(e2, r2, t2, n2, i2) {
  var a2 = e2.type, u2 = [];
  if (e2.required || !e2.required && n2.hasOwnProperty(e2.field)) {
    if (f(r2, a2) && !e2.required)
      return t2();
    w.required(e2, r2, n2, u2, i2, a2), f(r2, a2) || w.type(e2, r2, n2, u2, i2);
  }
  t2(u2);
}, O = { string: function(e2, r2, t2, n2, i2) {
  var a2 = [];
  if (e2.required || !e2.required && n2.hasOwnProperty(e2.field)) {
    if (f(r2, "string") && !e2.required)
      return t2();
    w.required(e2, r2, n2, a2, i2, "string"), f(r2, "string") || (w.type(e2, r2, n2, a2, i2), w.range(e2, r2, n2, a2, i2), w.pattern(e2, r2, n2, a2, i2), true === e2.whitespace && w.whitespace(e2, r2, n2, a2, i2));
  }
  t2(a2);
}, method: function(e2, r2, t2, n2, i2) {
  var a2 = [];
  if (e2.required || !e2.required && n2.hasOwnProperty(e2.field)) {
    if (f(r2) && !e2.required)
      return t2();
    w.required(e2, r2, n2, a2, i2), void 0 !== r2 && w.type(e2, r2, n2, a2, i2);
  }
  t2(a2);
}, number: function(e2, r2, t2, n2, i2) {
  var a2 = [];
  if (e2.required || !e2.required && n2.hasOwnProperty(e2.field)) {
    if ("" === r2 && (r2 = void 0), f(r2) && !e2.required)
      return t2();
    w.required(e2, r2, n2, a2, i2), void 0 !== r2 && (w.type(e2, r2, n2, a2, i2), w.range(e2, r2, n2, a2, i2));
  }
  t2(a2);
}, boolean: function(e2, r2, t2, n2, i2) {
  var a2 = [];
  if (e2.required || !e2.required && n2.hasOwnProperty(e2.field)) {
    if (f(r2) && !e2.required)
      return t2();
    w.required(e2, r2, n2, a2, i2), void 0 !== r2 && w.type(e2, r2, n2, a2, i2);
  }
  t2(a2);
}, regexp: function(e2, r2, t2, n2, i2) {
  var a2 = [];
  if (e2.required || !e2.required && n2.hasOwnProperty(e2.field)) {
    if (f(r2) && !e2.required)
      return t2();
    w.required(e2, r2, n2, a2, i2), f(r2) || w.type(e2, r2, n2, a2, i2);
  }
  t2(a2);
}, integer: function(e2, r2, t2, n2, i2) {
  var a2 = [];
  if (e2.required || !e2.required && n2.hasOwnProperty(e2.field)) {
    if (f(r2) && !e2.required)
      return t2();
    w.required(e2, r2, n2, a2, i2), void 0 !== r2 && (w.type(e2, r2, n2, a2, i2), w.range(e2, r2, n2, a2, i2));
  }
  t2(a2);
}, float: function(e2, r2, t2, n2, i2) {
  var a2 = [];
  if (e2.required || !e2.required && n2.hasOwnProperty(e2.field)) {
    if (f(r2) && !e2.required)
      return t2();
    w.required(e2, r2, n2, a2, i2), void 0 !== r2 && (w.type(e2, r2, n2, a2, i2), w.range(e2, r2, n2, a2, i2));
  }
  t2(a2);
}, array: function(e2, r2, t2, n2, i2) {
  var a2 = [];
  if (e2.required || !e2.required && n2.hasOwnProperty(e2.field)) {
    if (null == r2 && !e2.required)
      return t2();
    w.required(e2, r2, n2, a2, i2, "array"), null != r2 && (w.type(e2, r2, n2, a2, i2), w.range(e2, r2, n2, a2, i2));
  }
  t2(a2);
}, object: function(e2, r2, t2, n2, i2) {
  var a2 = [];
  if (e2.required || !e2.required && n2.hasOwnProperty(e2.field)) {
    if (f(r2) && !e2.required)
      return t2();
    w.required(e2, r2, n2, a2, i2), void 0 !== r2 && w.type(e2, r2, n2, a2, i2);
  }
  t2(a2);
}, enum: function(e2, r2, t2, n2, i2) {
  var a2 = [];
  if (e2.required || !e2.required && n2.hasOwnProperty(e2.field)) {
    if (f(r2) && !e2.required)
      return t2();
    w.required(e2, r2, n2, a2, i2), void 0 !== r2 && w.enum(e2, r2, n2, a2, i2);
  }
  t2(a2);
}, pattern: function(e2, r2, t2, n2, i2) {
  var a2 = [];
  if (e2.required || !e2.required && n2.hasOwnProperty(e2.field)) {
    if (f(r2, "string") && !e2.required)
      return t2();
    w.required(e2, r2, n2, a2, i2), f(r2, "string") || w.pattern(e2, r2, n2, a2, i2);
  }
  t2(a2);
}, date: function(e2, r2, t2, n2, i2) {
  var a2 = [];
  if (e2.required || !e2.required && n2.hasOwnProperty(e2.field)) {
    if (f(r2, "date") && !e2.required)
      return t2();
    var u2;
    if (w.required(e2, r2, n2, a2, i2), !f(r2, "date"))
      u2 = r2 instanceof Date ? r2 : new Date(r2), w.type(e2, u2, n2, a2, i2), u2 && w.range(e2, u2.getTime(), n2, a2, i2);
  }
  t2(a2);
}, url: F, hex: F, email: F, required: function(e2, r2, t2, n2, i2) {
  var a2 = [], u2 = Array.isArray(r2) ? "array" : typeof r2;
  w.required(e2, r2, n2, a2, i2, u2), t2(a2);
}, any: function(e2, r2, t2, n2, i2) {
  var a2 = [];
  if (e2.required || !e2.required && n2.hasOwnProperty(e2.field)) {
    if (f(r2) && !e2.required)
      return t2();
    w.required(e2, r2, n2, a2, i2);
  }
  t2(a2);
} };
function x() {
  return { default: "Validation error on field %s", required: "%s is required", enum: "%s must be one of %s", whitespace: "%s cannot be empty", date: { format: "%s date %s is invalid for format %s", parse: "%s date could not be parsed, %s is invalid ", invalid: "%s date %s is invalid" }, types: { string: "%s is not a %s", method: "%s is not a %s (function)", array: "%s is not an %s", object: "%s is not an %s", number: "%s is not a %s", date: "%s is not a %s", boolean: "%s is not a %s", integer: "%s is not an %s", float: "%s is not a %s", regexp: "%s is not a valid %s", email: "%s is not a valid %s", url: "%s is not a valid %s", hex: "%s is not a valid %s" }, string: { len: "%s must be exactly %s characters", min: "%s must be at least %s characters", max: "%s cannot be longer than %s characters", range: "%s must be between %s and %s characters" }, number: { len: "%s must equal %s", min: "%s cannot be less than %s", max: "%s cannot be greater than %s", range: "%s must be between %s and %s" }, array: { len: "%s must be exactly %s in length", min: "%s cannot be less than %s in length", max: "%s cannot be greater than %s in length", range: "%s must be between %s and %s in length" }, pattern: { mismatch: "%s value %s does not match pattern %s" }, clone: function() {
    var e2 = JSON.parse(JSON.stringify(this));
    return e2.clone = this.clone, e2;
  } };
}
var j = x(), E = function() {
  function r2(e2) {
    this.rules = null, this._messages = j, this.define(e2);
  }
  var t2 = r2.prototype;
  return t2.define = function(e2) {
    var r3 = this;
    if (!e2)
      throw new Error("Cannot configure a schema with no rules");
    if ("object" != typeof e2 || Array.isArray(e2))
      throw new Error("Rules must be an object");
    this.rules = {}, Object.keys(e2).forEach(function(t3) {
      var n2 = e2[t3];
      r3.rules[t3] = Array.isArray(n2) ? n2 : [n2];
    });
  }, t2.messages = function(e2) {
    return e2 && (this._messages = y(x(), e2)), this._messages;
  }, t2.validate = function(t3, n2, i2) {
    var a2 = this;
    void 0 === n2 && (n2 = {}), void 0 === i2 && (i2 = function() {
    });
    var u2 = t3, f2 = n2, l2 = i2;
    if ("function" == typeof f2 && (l2 = f2, f2 = {}), !this.rules || 0 === Object.keys(this.rules).length)
      return l2 && l2(null, u2), Promise.resolve(u2);
    if (f2.messages) {
      var c2 = this.messages();
      c2 === j && (c2 = x()), y(c2, f2.messages), f2.messages = c2;
    } else
      f2.messages = this.messages();
    var g2 = {};
    (f2.keys || Object.keys(this.rules)).forEach(function(r3) {
      var n3 = a2.rules[r3], i3 = u2[r3];
      n3.forEach(function(n4) {
        var s2 = n4;
        "function" == typeof s2.transform && (u2 === t3 && (u2 = e({}, u2)), i3 = u2[r3] = s2.transform(i3)), (s2 = "function" == typeof s2 ? { validator: s2 } : e({}, s2)).validator = a2.getValidationMethod(s2), s2.validator && (s2.field = r3, s2.fullField = s2.fullField || r3, s2.type = a2.getType(s2), g2[r3] = g2[r3] || [], g2[r3].push({ rule: s2, value: i3, source: u2, field: r3 }));
      });
    });
    var h2 = {};
    return d(g2, f2, function(t4, n3) {
      var i3, a3 = t4.rule, s2 = !("object" !== a3.type && "array" !== a3.type || "object" != typeof a3.fields && "object" != typeof a3.defaultField);
      function l3(r3, t5) {
        return e({}, t5, { fullField: a3.fullField + "." + r3, fullFields: a3.fullFields ? [].concat(a3.fullFields, [r3]) : [r3] });
      }
      function c3(i4) {
        void 0 === i4 && (i4 = []);
        var c4 = Array.isArray(i4) ? i4 : [i4];
        !f2.suppressWarning && c4.length && r2.warning("async-validator:", c4), c4.length && void 0 !== a3.message && (c4 = [].concat(a3.message));
        var d2 = c4.map(p(a3, u2));
        if (f2.first && d2.length)
          return h2[a3.field] = 1, n3(d2);
        if (s2) {
          if (a3.required && !t4.value)
            return void 0 !== a3.message ? d2 = [].concat(a3.message).map(p(a3, u2)) : f2.error && (d2 = [f2.error(a3, o(f2.messages.required, a3.field))]), n3(d2);
          var y2 = {};
          a3.defaultField && Object.keys(t4.value).map(function(e2) {
            y2[e2] = a3.defaultField;
          }), y2 = e({}, y2, t4.rule.fields);
          var g3 = {};
          Object.keys(y2).forEach(function(e2) {
            var r3 = y2[e2], t5 = Array.isArray(r3) ? r3 : [r3];
            g3[e2] = t5.map(l3.bind(null, e2));
          });
          var v2 = new r2(g3);
          v2.messages(f2.messages), t4.rule.options && (t4.rule.options.messages = f2.messages, t4.rule.options.error = f2.error), v2.validate(t4.value, t4.rule.options || f2, function(e2) {
            var r3 = [];
            d2 && d2.length && r3.push.apply(r3, d2), e2 && e2.length && r3.push.apply(r3, e2), n3(r3.length ? r3 : null);
          });
        } else
          n3(d2);
      }
      if (s2 = s2 && (a3.required || !a3.required && t4.value), a3.field = t4.field, a3.asyncValidator)
        i3 = a3.asyncValidator(a3, t4.value, c3, t4.source, f2);
      else if (a3.validator) {
        try {
          i3 = a3.validator(a3, t4.value, c3, t4.source, f2);
        } catch (e2) {
          null == console.error || console.error(e2), f2.suppressValidatorError || setTimeout(function() {
            throw e2;
          }, 0), c3(e2.message);
        }
        true === i3 ? c3() : false === i3 ? c3("function" == typeof a3.message ? a3.message(a3.fullField || a3.field) : a3.message || (a3.fullField || a3.field) + " fails") : i3 instanceof Array ? c3(i3) : i3 instanceof Error && c3(i3.message);
      }
      i3 && i3.then && i3.then(function() {
        return c3();
      }, function(e2) {
        return c3(e2);
      });
    }, function(e2) {
      !function(e3) {
        for (var r3, t4, n3 = [], i3 = {}, a3 = 0; a3 < e3.length; a3++)
          r3 = e3[a3], t4 = void 0, Array.isArray(r3) ? n3 = (t4 = n3).concat.apply(t4, r3) : n3.push(r3);
        n3.length ? (i3 = s(n3), l2(n3, i3)) : l2(null, u2);
      }(e2);
    }, u2);
  }, t2.getType = function(e2) {
    if (void 0 === e2.type && e2.pattern instanceof RegExp && (e2.type = "pattern"), "function" != typeof e2.validator && e2.type && !O.hasOwnProperty(e2.type))
      throw new Error(o("Unknown rule type %s", e2.type));
    return e2.type || "string";
  }, t2.getValidationMethod = function(e2) {
    if ("function" == typeof e2.validator)
      return e2.validator;
    var r3 = Object.keys(e2), t3 = r3.indexOf("message");
    return -1 !== t3 && r3.splice(t3, 1), 1 === r3.length && "required" === r3[0] ? O.required : O[this.getType(e2)] || void 0;
  }, r2;
}();
E.register = function(e2, r2) {
  if ("function" != typeof r2)
    throw new Error("Cannot register a validator by type, validator is not a function");
  O[e2] = r2;
}, E.warning = u, E.messages = j, E.validators = O;
export { E as S };
