import { w as t } from "../utils/index.js";
import { defineComponent as e, ref as o, computed as l, onMounted as a, nextTick as f, onUnmounted as s, openBlock as r, createElementBlock as i, normalizeStyle as u, unref as n, renderSlot as p } from "vue";
const v = t(e({ name: "LayAffix", props: { offset: { default: 0 }, target: { default: () => document.body }, position: { default: "top" } }, emits: ["scroll"], setup(t2, { emit: e2 }) {
  const v2 = t2, g = o(false), d = o();
  let m = 0, c = 0, x = 0, y = 0, T = 0, h = 0;
  const w = l(() => {
    if (g.value && d.value) {
      let t3 = { position: "fixed !important", top: "unset", bottom: "unset", left: c - x + "px" };
      return "top" === v2.position ? t3.top = h - y + "px" : t3.bottom = h - T + "px", t3;
    }
  }), b = () => {
    var _a;
    if (d.value) {
      let t3 = d.value.offsetTop, o2 = (_a = v2.target) == null ? void 0 : _a.scrollTop;
      if ("top" === v2.position) {
        t3 - o2 + v2.target.offsetTop < h && (g.value ? o2 <= m && (g.value = false) : (m = o2, g.value = true));
      } else {
        let e3 = (v2.target.offsetHeight > window.innerHeight ? window.innerHeight : v2.target.offsetHeight) + o2 - t3 - d.value.offsetHeight;
        g.value ? o2 >= m && (g.value = false) : e3 < h && (m = o2 - e3 + v2.offset, g.value = true);
      }
      e2("scroll", { targetScroll: o2, affixed: g.value, offset: g.value ? Math.abs(o2 - m) : 0 });
    }
  }, H = (t3, e3) => t3.currentStyle ? t3.currentStyle[e3] : document.defaultView.getComputedStyle(t3, null)[e3];
  return a(() => {
    f(() => {
      d.value.offsetTop, v2.target.offsetTop, c = d.value.getBoundingClientRect().left, x = parseFloat(H(d.value, "marginLeft")), y = parseFloat(H(d.value, "marginTop")), T = parseFloat(H(d.value, "marginBottom")), h = v2.offset + v2.target.offsetTop, "bottom" === v2.position && (h = v2.offset), v2.target.addEventListener("scroll", b, true), b();
    });
  }), s(() => {
    v2.target.removeEventListener("scroll", b);
  }), (t3, e3) => (r(), i("div", { class: "layui-affix", style: u(n(w)), ref_key: "dom", ref: d }, [p(t3.$slots, "default")], 4));
} }));
export { v as default };
