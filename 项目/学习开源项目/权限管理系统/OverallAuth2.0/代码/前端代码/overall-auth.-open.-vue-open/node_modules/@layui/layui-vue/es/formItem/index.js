import { w as e } from "../utils/index.js";
import { computed as s, inject as l, defineComponent as r, ref as a, watch as o, onMounted as i, reactive as t, toRefs as n, onUnmounted as u, useSlots as d, openBlock as m, createElementBlock as p, normalizeClass as c, unref as v, normalizeStyle as f, renderSlot as g, createTextVNode as b, toDisplayString as y, createCommentVNode as h, createElementVNode as q } from "vue";
import { S as x } from "../_chunks/async-validator/index.js";
var E = { default: "%s\u9A8C\u8BC1\u5931\u8D25", required: "%s\u4E0D\u80FD\u4E3A\u7A7A", enum: "%s\u4E0D\u5728\u679A\u4E3E%s\u91CC\u9762", whitespace: "%s\u4E0D\u80FD\u4E3A\u7A7A", date: { format: "%s\u65E5\u671F%s\u4E0D\u662F\u4E00\u4E2A\u6709\u6548\u683C\u5F0F\u7684\u65E5\u671F%s", parse: "%s\u65E0\u6CD5\u89E3\u6790\u4E3A\u65E5\u671F,%s\u662F\u65E0\u6548\u7684", invalid: "%s\u65E5\u671F%s\u662F\u65E0\u6548\u7684" }, types: { number: "%s\u4E0D\u662F\u4E00\u4E2A\u6709\u6548\u7684\u6570\u5B57", boolean: "%s\u4E0D\u662F\u4E00\u4E2A\u6709\u6548\u7684\u5E03\u5C14\u7C7B\u578B", method: "%s\u4E0D\u662F\u4E00\u4E2A\u6709\u6548\u7684\u65B9\u6CD5", regexp: "%s\u4E0D\u662F\u4E00\u4E2A\u6709\u6548\u7684\u6B63\u5219\u8868\u8FBE\u5F0F", integer: "%s\u4E0D\u662F\u4E00\u4E2A\u6709\u6548\u7684\u6574\u578B\u6570\u5B57", float: "%s\u4E0D\u662F\u4E00\u4E2A\u6709\u6548\u7684\u6D6E\u70B9\u5C0F\u6570", array: "%s\u4E0D\u662F\u4E00\u4E2A\u6709\u6548\u7684\u6570\u7EC4", object: "%s\u4E0D\u662F\u4E00\u4E2A\u6709\u6548\u7684\u5BF9\u8C61", enum: "%s\u4E0D\u662F\u4E00\u4E2A\u6709\u6548\u7684\u679A\u4E3E", date: "%s\u4E0D\u662F\u4E00\u4E2A\u6709\u6548\u7684\u65E5\u671F", url: "%s\u4E0D\u662F\u4E00\u4E2A\u6709\u6548\u7684url", hex: "%s\u4E0D\u662F\u4E00\u4E2A\u6709\u6548\u7684\u5341\u516D\u8FDB\u5236", email: "%s\u4E0D\u662F\u4E00\u4E2A\u6709\u6548\u7684\u90AE\u7BB1" }, string: { len: "%s\u5FC5\u987B\u662F\u957F\u5EA6\u4E3A%s\u4E2A\u5B57\u7B26", min: "%s\u6700\u5C0F\u957F\u5EA6\u4E3A%s\u4E2A\u5B57\u7B26", max: "%s\u6700\u957F%s\u4E2A\u5B57\u7B26", range: "%s\u5B57\u7B26\u957F\u5EA6\u9700\u8981\u5728%s\u548C%s\u4E4B\u95F4" }, number: { len: "%s\u957F\u5EA6\u5FC5\u987B\u4E3A%s", min: "%s\u5FC5\u987B\u5C0F\u4E8E%s", max: "%s\u5FC5\u987B\u5927\u4E8E%s", range: "%s\u9700\u8981\u5728%s\u548C%s\u4E4B\u95F4" }, array: { len: "%s\u957F\u5EA6\u5FC5\u987B\u4E3A%s", min: "%s\u957F\u5EA6\u5FC5\u987B\u5C0F\u4E8E%s", max: "%s\u957F\u5EA6\u5FC5\u987B\u5927\u4E8E%s", range: "%s\u957F\u5EA6\u9700\u8981\u5728%s\u548C%s\u4E4B\u95F4" }, pattern: { mismatch: "%s\u503C%s\u4E0D\u80FD\u5339\u914D%s" } };
const M = ["size"], k = e(r({ name: "LayFormItem", props: { prop: null, mode: { default: "block" }, label: null, labelPosition: null, labelWidth: null, errorMessage: null, rules: null, required: { type: Boolean }, requiredErrorMessage: null, size: null }, setup(e2, { expose: r2 }) {
  const k2 = e2, { size: $ } = function(e3) {
    return { size: s(() => {
      const s2 = l("LayForm", {});
      return e3.size || s2.size || "md";
    }) };
  }(k2), j = l("LayForm", {}), z = a(), C = a(), F = s(() => k2.required || j.required), L = s(() => k2.labelPosition || j.labelPosition), O = s(() => {
    const e3 = k2.prop;
    if (!e3)
      return {};
    let s2 = [];
    return F.value && s2.push({ required: true }), k2.rules && (s2 = s2.concat(k2.rules)), j.rules && j.rules[e3] && (s2 = s2.concat(j.rules[e3])), s2;
  }), w = s(() => k2.prop ? -1 != k2.prop.indexOf(".") ? function(e3, s2, l2) {
    const r3 = s2.replace(/\[(\d+)\]/g, ".$1").split(".");
    let a2 = e3;
    for (const e4 of r3)
      if (a2 = Object(a2)[e4], void 0 === a2)
        return l2;
    return a2;
  }(j.model, k2.prop) : j.model[k2.prop] : void 0);
  o(() => w.value, (e3) => N(), { deep: true });
  const I = a(), P = a(false), N = (e3) => {
    if (k2.prop && O.value.length > 0) {
      const s2 = {};
      s2[j.useCN && k2.label || k2.prop] = O.value;
      const l2 = new x(s2);
      let r3 = {}, a2 = null;
      j.useCN ? (a2 = Object.assign({}, E, j.validateMessage), r3[k2.label || k2.prop] = w.value) : (j.validateMessage && (a2 = j.validateMessage), r3[k2.prop] = w.value), j.requiredErrorMessage && (a2 = Object.assign(a2, { required: j.requiredErrorMessage })), k2.requiredErrorMessage && (a2 = Object.assign(a2, { required: k2.requiredErrorMessage })), a2 && l2.messages(a2), l2.validate(r3, (s3, l3) => {
        var _a, _b;
        P.value = null !== s3 && s3.length > 0;
        const r4 = C.value;
        if (P.value) {
          const a3 = s3;
          j.useCN && a3.forEach((e4) => {
            e4.label = k2.label, e4.field = k2.prop;
          }), I.value = (_a = k2.errorMessage) != null ? _a : a3[0].message, (r4 == null ? void 0 : r4.childElementCount) > 0 && ((_b = r4 == null ? void 0 : r4.firstElementChild) == null ? void 0 : _b.classList.add("layui-form-danger")), e3 && e3(a3, l3);
        } else
          V();
      });
    }
  }, V = () => {
    var _a;
    P.value = false, I.value = "";
    const e3 = C.value;
    (e3 == null ? void 0 : e3.childElementCount) > 0 && ((_a = e3 == null ? void 0 : e3.firstElementChild) == null ? void 0 : _a.classList.remove("layui-form-danger"));
  };
  r2({ validate: N, clearValidate: V }), i(() => {
    k2.prop && j.addField(t({ ...n(k2), $el: z, validate: N, clearValidate: V }));
  }), u(() => {
    k2.prop && j.removeField(t({ ...n(k2), $el: z, validate: N, clearValidate: V }));
  });
  const W = d(), _ = s(() => null != W.label || null != k2.label), B = s(() => k2.labelWidth || j.labelWidth || 95), R = s(() => {
    if ("block" == k2.mode) {
      if ("top" != L.value) {
        let e3 = "string" == typeof B.value ? parseFloat(B.value) : B.value;
        return j.pane || (e3 += 15), void 0 === W.label && void 0 === k2.label ? { "margin-left": "0px" } : { "margin-left": `${e3}px` };
      }
      return { "margin-left": "0px" };
    }
  });
  return (s2, l2) => {
    var _a;
    return m(), p("div", { class: c(["layui-form-item", [`layui-form-item-${v(L)}`, e2.mode]]), size: v($), ref_key: "formItemRef", ref: z }, [v(_) ? (m(), p("label", { key: 0, class: "layui-form-label", style: f({ width: v(B) + "px" }) }, [k2.prop && v(F) ? (m(), p("span", { key: 0, class: c(["layui-required", "layui-icon"].concat((_a = v(j).requiredIcons) != null ? _a : "")) }, [g(s2.$slots, "required", { props: { ...k2, model: v(j).model } }, () => [b(y(v(j).requiredIcons ? "" : "*"), 1)])], 2)) : h("", true), g(s2.$slots, "label", { props: { ...k2, model: v(j).model } }, () => [b(y(e2.label), 1)])], 4)) : h("", true), q("div", { class: c([e2.mode ? "layui-input-" + e2.mode : ""]), style: f(v(R)) }, [q("div", { ref_key: "slotParent", ref: C }, [g(s2.$slots, "default", { props: { ...k2, model: v(j).model } })], 512), P.value ? (m(), p("span", { key: 0, class: c(["layui-error-message", { "layui-error-message-anim": P.value }]) }, y(I.value), 3)) : h("", true)], 6)], 10, M);
  };
} }));
export { k as default };
