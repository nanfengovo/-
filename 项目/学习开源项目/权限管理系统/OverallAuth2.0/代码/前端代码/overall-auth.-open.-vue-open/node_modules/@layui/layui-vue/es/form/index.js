import { w as e } from "../utils/index.js";
import { defineComponent as t, onMounted as l, provide as o, reactive as a, toRefs as n, openBlock as r, createElementBlock as i, normalizeClass as u, renderSlot as s, nextTick as c } from "vue";
const f = e(t({ name: "LayForm", props: { model: { default: function() {
  return {};
} }, required: { type: Boolean }, rules: null, pane: { type: Boolean, default: false }, initValidate: { type: Boolean, default: false }, requiredIcons: { default: "" }, labelPosition: { default: "right" }, labelWidth: null, requiredErrorMessage: null, validateMessage: null, useCN: { type: Boolean, default: true }, size: null }, emits: ["submit"], setup(e2, { expose: t2, emit: f2 }) {
  const d = e2, p = [], m = {};
  l(() => {
    var _a;
    d.initValidate && ((_a = h()) == null ? void 0 : _a.catch((e3) => {
    }));
  });
  const y = function() {
    let e3 = false;
    return h((t3, l2, o2) => {
      e3 = t3, f2("submit", t3, l2, o2);
    }), e3;
  }, h = function(e3, t3) {
    let l2 = p;
    if ("function" == typeof e3)
      t3 = e3;
    else if ("string" == typeof e3 || Array.isArray(e3) && e3.length > 0) {
      l2 = [];
      (e3 ? [].concat(e3) : []).forEach((e4) => m[e4] && l2.push(m[e4]));
    }
    let o2 = [];
    l2.forEach((e4) => {
      e4.validate((e5, t4) => {
        o2 = o2.concat(e5);
      });
    });
    const a2 = 0 === o2.length;
    return "function" == typeof t3 ? (a2 ? t3(true, d.model, null) : t3(false, d.model, o2), null) : new Promise((e4, t4) => {
      const l3 = { isValidate: a2, model: d.model, errors: a2 ? null : o2 };
      l3.isValidate ? e4(l3) : t4(l3);
    });
  }, g = function(e3) {
    const t3 = e3 ? [].concat(e3) : [];
    0 === t3.length ? p.forEach((e4) => e4.clearValidate()) : t3.forEach((e4) => m[e4] && m[e4].clearValidate());
  }, V = (e3) => {
    for (const t3 in e3)
      e3[t3] instanceof Object && !(e3[t3] instanceof Function) ? e3[t3] instanceof Array ? e3[t3] = [] : V(e3[t3]) : e3[t3] = null;
  };
  return t2({ validate: h, clearValidate: g, reset: function() {
    V(d.model), c(() => g());
  } }), o("LayForm", a({ formItems: p, addField: function(e3) {
    p.push(e3), m[e3.prop] = e3;
  }, removeField: function(e3) {
    for (var t3 = 0; t3 < p.length; t3++)
      p[t3].prop == e3.prop && p.splice(t3, 1);
    null != e3.prop && Reflect.deleteProperty(m, e3.prop);
  }, clearValidate: g, validate: h, ...n(d) })), (t3, l2) => (r(), i("form", { class: u(["layui-form", { "layui-form-pane": e2.pane }]), onsubmit: y }, [s(t3.$slots, "default")], 2));
} }));
export { f as default };
