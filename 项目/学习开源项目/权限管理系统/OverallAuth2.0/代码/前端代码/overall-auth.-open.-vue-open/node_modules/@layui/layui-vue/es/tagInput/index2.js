import { w as e } from "../utils/index.js";
import { defineComponent as l, useSlots as a, shallowRef as u, ref as s, reactive as o, computed as n, watch as t, nextTick as i, onMounted as p, openBlock as d, createElementBlock as r, normalizeClass as v, unref as c, createElementVNode as m, toDisplayString as f, renderSlot as y, createCommentVNode as g, Fragment as b, renderList as h, createBlock as C, mergeProps as x, withCtx as k, createTextVNode as z, createVNode as $, normalizeStyle as _, withKeys as V, withModifiers as w } from "vue";
import { _ as B } from "../tag/index2.js";
import { _ as N } from "../tooltip/index2.js";
import { r as j, i as T, a as D } from "../_chunks/@vueuse/index.js";
import { _ as E } from "../checkbox/index2.js";
const I = { key: 0, class: "layui-tag-input-prepend" }, S = { key: 1 }, K = { class: "layui-tag-input-inner" }, P = { class: "layui-tag-input-collapsed-panel" }, R = ["disabled", "placeholder", "readonly", "onKeydown"], A = { key: 2, class: "layui-tag-input-clear" }, F = { key: 3, class: "layui-tag-input-suffix" }, L = { key: 4, class: "layui-tag-input-append" }, M = l({ name: "LayTagInput", props: { modelValue: null, inputValue: null, disabled: { type: Boolean }, placeholder: { default: void 0 }, readonly: { type: Boolean }, allowClear: { type: Boolean }, max: null, minCollapsedNum: { default: 0 }, collapseTagsTooltip: { type: Boolean }, size: { default: "md" }, tagProps: null, disabledInput: { type: Boolean } }, emits: ["change", "update:modelValue", "update:inputValue", "inputValueChange", "pressEnter", "remove", "clear", "focus", "blur"], setup(e2, { expose: l2, emit: M2 }) {
  var _a;
  const W2 = e2, q = a(), G = u(void 0), H = u(void 0), J = s(""), O = s(""), Q = s(false), U = o({ width: "15px" }), X = o((_a = W2.tagProps) != null ? _a : {}), Y = j(X, "closable", "size", "disabled"), Z = n({ get: () => W2.inputValue, set(e3) {
    M2("update:inputValue", e3), M2("inputValueChange", e3);
  } }), ee = n({ get: () => W2.modelValue, set(e3) {
    M2("update:modelValue", e3), M2("change", e3);
  } }), le = n(() => {
    var _a2;
    return fe((_a2 = ee.value) != null ? _a2 : []);
  }), ae = n(() => {
    var _a2;
    if (le.value)
      return W2.minCollapsedNum ? (_a2 = le.value) == null ? void 0 : _a2.slice(0, W2.minCollapsedNum) : le.value;
  }), ue = n(() => {
    var _a2, _b;
    if (le.value)
      return W2.minCollapsedNum && ((_a2 = le.value) == null ? void 0 : _a2.length) > W2.minCollapsedNum ? (_b = le.value) == null ? void 0 : _b.slice(W2.minCollapsedNum) : [];
  }), se = function(e3) {
    Q.value || (Z.value = e3.target.value);
  }, oe = (e3) => {
    var _a2;
    "compositionend" === e3.type ? (Q.value = false, O.value = "", se(e3)) : (Q.value = true, O.value = Z.value + ((_a2 = e3.data) != null ? _a2 : ""));
  }, ne = (e3) => {
    var _a2;
    e3.preventDefault();
    const l3 = Z.value ? String(Z.value).trim() : "";
    if (!l3 || !ee.value)
      return;
    W2.max && ((_a2 = ee.value) == null ? void 0 : _a2.length) >= W2.max || (ee.value = ee.value instanceof Array ? ee.value.concat(String(l3)) : [l3], Z.value = ""), M2("pressEnter", Z.value, e3);
  }, te = (e3) => {
    var _a2;
    if (ee.value && ee.value.length) {
      if (!J.value && ["Backspace", "Delete"].includes(e3.code)) {
        const l3 = le.value.length - 1;
        re(le.value[l3].value, l3, e3);
      }
      J.value = (_a2 = Z.value) != null ? _a2 : "";
    }
  }, ie = (e3) => {
    var _a2;
    M2("focus", e3), (_a2 = H.value) == null ? void 0 : _a2.focus();
  }, pe = (e3) => {
    var _a2;
    M2("blur", e3), (_a2 = H.value) == null ? void 0 : _a2.blur();
  }, de = (e3) => {
    W2.disabled || W2.readonly || !W2.allowClear || (ee.value = [], M2("clear", e3));
  }, re = (e3, l3, a2) => {
    if (!ee.value)
      return;
    const u2 = [...ee.value];
    u2.splice(l3, 1), ee.value = u2, M2("remove", e3, a2);
  }, ve = (e3) => {
    H.value && (e3.preventDefault(), H.value.focus());
  }, ce = () => {
    var e3;
    G.value && (e3 = G.value.offsetWidth, U.width = e3 > 15 ? `${e3}px` : "15px");
  }, me = n(() => ["layui-tag-input", `layui-tag-input-${W2.size}`, { "layui-tag-input-disabled": W2.disabled }]), fe = (e3) => e3.map((e4) => T(e4) ? e4 : { value: e4, label: String(e4), closable: true });
  D(G, () => {
    ce();
  }), t(() => Z.value, (e3) => {
    H.value && !Q.value && i(() => {
      H.value.value = e3 != null ? e3 : "";
    });
  });
  const ye = n(() => {
    if (ee.value && ae.value)
      return ee.value.length - ae.value.length;
  });
  return p(() => {
    ce();
  }), l2({ focus: ie, blur: pe }), (l3, a2) => {
    var _a2, _b, _c;
    return d(), r("div", { class: v(c(me)), onMousedown: ve }, [m("span", { ref_key: "mirrorRefEl", ref: G, class: "layui-tag-input-mirror" }, f(O.value || c(Z) || e2.placeholder), 513), c(q).prepend ? (d(), r("div", I, [y(l3.$slots, "prepend")])) : g("", true), l3.$slots.prefix ? (d(), r("span", S, [y(l3.$slots, "prefix")])) : g("", true), m("span", K, [(d(true), r(b, null, h(c(ae), (l4, a3) => (d(), C(B, x({ key: `${l4}-${a3}` }, c(Y), { closable: !e2.readonly && !e2.disabled && l4.closable, size: e2.size, onClose: (e3) => re(l4.value, a3, e3) }), { default: k(() => [z(f(l4.label), 1)]), _: 2 }, 1040, ["closable", "size", "onClose"]))), 128)), ((_a2 = c(ae)) == null ? void 0 : _a2.length) != ((_b = c(ee)) == null ? void 0 : _b.length) ? (d(), C(N, { key: 0, isDark: false, trigger: "hover", popperStyle: "padding:6px", disabled: !e2.collapseTagsTooltip }, { content: k(() => [m("div", P, [(d(true), r(b, null, h(c(ue), (l4, a3) => (d(), C(B, x({ key: `${l4}-${a3}` }, c(Y), { closable: !e2.readonly && !e2.disabled && l4.closable, size: e2.size, onClose: (u2) => {
      var _a3;
      return re(l4.value, a3 + ((_a3 = e2.minCollapsedNum) != null ? _a3 : 0), u2);
    } }), { default: k(() => [z(f(l4.label), 1)]), _: 2 }, 1040, ["closable", "size", "onClose"]))), 128))])]), default: k(() => [$(B, x(c(Y), { key: "more", closable: false, size: e2.size }), { default: k(() => [z(" +" + f(c(ye)) + "... ", 1)]), _: 1 }, 16, ["size"])]), _: 1 }, 8, ["disabled"])) : g("", true), m("input", { ref_key: "inputRefEl", ref: H, class: "layui-tag-input-inner-input", style: _(U), disabled: e2.disabled || e2.disabledInput, placeholder: e2.placeholder, readonly: e2.readonly, onKeydown: V(ne, ["enter"]), onKeyup: te, onInput: se, onFocus: ie, onBlur: pe, onCompositionstart: oe, onCompositionupdate: oe, onCompositionend: oe }, null, 44, R)]), e2.allowClear && ((_c = c(ee)) == null ? void 0 : _c.length) && !e2.disabled ? (d(), r("span", A, [$(c(E), { type: "layui-icon-close-fill", onClick: w(de, ["stop"]) }, null, 8, ["onClick"])])) : g("", true), l3.$slots.suffix ? (d(), r("span", F, [y(l3.$slots, "suffix")])) : g("", true), c(q).append ? (d(), r("div", L, [y(l3.$slots, "append")])) : g("", true)], 34);
  };
} }), W = e(M);
export { M as _, W as c };
